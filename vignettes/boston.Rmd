---
title: "Boston Housing Example"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Boston Housing Example}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

To begin, load the `statnn` package.

```{r setup}
library(statnn)
```

There are three other packages that we will load.
The first is the package we will use to fit the neural network.
Our package works with a number of popular R packages for neural networks, and
here we will use the `nnet` package.
The second is the `ISLR2` package, which contains the Boston Housing data set.
Finally, the third package, `caret`, will be used for some data 
preprocessing.

```{r, message=FALSE, warning=FALSE}
library(nnet)
library(ISLR2)
library(caret)
```

We first load the data and do some preprocessing.

```{r}
# load data ---------------------------------------------------------------
data(Boston)

# preprocess --------------------------------------------------------------
std <- preProcess(Boston)

X <- predict(std, Boston)[, -ncol(Boston)]
y <- predict(std, Boston)[, ncol(Boston)]
```

Next, we fit a neural network.
As neural networks require random initial weights to begin learning, we use
`set.seed()` for reproducibility.

```{r}
set.seed(100)
nn <- nnet(X, y, size = 2, trace = FALSE,
           linout = TRUE, maxit = 1000)
```

We can then create a `statnn` object

```{r, cahce = TRUE}
stnn <- statnn(nn, X = as.matrix(X))
```

A useful summary table can then be produced using the `summary()` function

```{r}
summary(stnn)
```

This tells provides us with simple point estimates of the effects, and
the results from the multiple-parameter Wald test for each input.

We can visualise the covariate effects and their associated uncertainty using
the `plot()` function, which creates Partial Covariate Effect (PCE) plots.

```{r, cache = TRUE}
plot(stnn, conf_int = TRUE)
```

There is also a `plotnn()` function that visualise the significance of each weight
from the single-parameter Wald test.
```{r}
plotnn(stnn)
```

